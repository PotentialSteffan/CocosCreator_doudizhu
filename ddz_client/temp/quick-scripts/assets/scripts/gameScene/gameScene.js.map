{"version":3,"sources":["gameScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/scripts/gameScene","sourcesContent":["import myglobal from \"../mygolbal\"\nconst { ccclass, property } = cc._decorator;\nimport {RoomState} from '../defines'\n@ccclass\nexport class gameScene extends cc.Component {\n\n    @property(cc.Label)\n    di_label: cc.Label = null;\n    @property(cc.Label)\n    beishu_label: cc.Label = null;\n    @property(cc.Label)\n    roomid_label: cc.Label = null;\n    @property(cc.Prefab)\n    player_node_prefabs: cc.Prefab = null;\n    //绑定玩家座位,下面有3个子节点\n    @property(cc.Node)\n    players_seat_pos: cc.Node = null;\n    //本局结束，做状态清除\n    gameEnd() {\n\n    }\n    playerNodeList;\n    roomstate;\n    isopen_sound:boolean = false;\n    playerdata_list_pos = {};\n    onLoad() {\n        this.playerNodeList = []\n        this.di_label.string = \"底:\" + myglobal.playerData.bottom\n        this.beishu_label.string = \"倍数:\" + myglobal.playerData.rate\n        this.roomstate = RoomState.ROOM_INVALID\n        //监听，给其他玩家发牌(内部事件)\n        this.node.on(\"pushcard_other_event\", function () {\n            console.log(\"gamescene pushcard_other_event\")\n            for (var i = 0; i < this.playerNodeList.length; i++) {\n                var node = this.playerNodeList[i]\n                if (node) {\n                    //给playernode节点发送事件\n                    node.emit(\"push_card_event\")\n                }\n            }\n        }.bind(this))\n\n        //监听房间状态改变事件\n        myglobal.socket.onRoomChangeState(function (data) {\n            //回调的函数参数是进入房间用户消息\n            console.log(\"onRoomChangeState:\" + data)\n            this.roomstate = data\n        }.bind(this))\n        //\n        this.node.on(\"canrob_event\", function (event) {\n            console.log(\"gamescene canrob_event:\" + event)\n            //通知给playernode子节点\n            for (var i = 0; i < this.playerNodeList.length; i++) {\n                var node = this.playerNodeList[i]\n                if (node) {\n                    //给playernode节点发送事件\n                    node.emit(\"playernode_canrob_event\", event)\n                }\n            }\n        }.bind(this))\n\n        this.node.on(\"choose_card_event\", function (event) {\n            console.log(\"--------choose_card_event-----------\")\n            var gameui_node = this.node.getChildByName(\"gameingUI\")\n            if (gameui_node == null) {\n                console.log(\"get childer name gameingUI\")\n                return\n            }\n            gameui_node.emit(\"choose_card_event\", event)\n\n        }.bind(this))\n\n        this.node.on(\"unchoose_card_event\", function (event) {\n            console.log(\"--------unchoose_card_event-----------\")\n            var gameui_node = this.node.getChildByName(\"gameingUI\")\n            if (gameui_node == null) {\n                console.log(\"get childer name gameingUI\")\n                return\n            }\n            gameui_node.emit(\"unchoose_card_event\", event)\n        }.bind(this))\n        //监听给玩家添加三张底牌\n        // this.node.on(\"add_three_card\",function(event){\n        //     console.log(\"add_three_card:\"+event)\n        //     for(var i=0;i<this.playerNodeList.length;i++){\n        //         var node = this.playerNodeList[i]\n        //         if(node){\n        //             //给playernode节点发送事件\n        //             node.emit(\"playernode_add_three_card\",event)\n        //         }\n        //     }\n        // }.bind(this))\n\n        myglobal.socket.request_enter_room({}, function (err, result) {\n            console.log(\"enter_room_resp\" + JSON.stringify(result))\n            if (err != 0) {\n                console.log(\"enter_room_resp err:\" + err)\n            } else {\n\n                //enter_room成功\n                //notify ={\"seatid\":1,\"playerdata\":[{\"accountid\":\"2117836\",\"nick_name\":\"tiny543\",\"avatarUrl\":\"http://xxx\",\"goldcount\":1000}]}\n                var seatid = result.seatindex //自己在房间里的seatid\n                this.playerdata_list_pos = []  //3个用户创建一个空用户列表\n                this.setPlayerSeatPos(seatid)\n\n                var playerdata_list = result.playerdata\n                var roomid = result.roomid\n                this.roomid_label.string = \"房间号:\" + roomid\n                myglobal.playerData.housemanageid = result.housemanageid\n\n                for (var i = 0; i < playerdata_list.length; i++) {\n                    //consol.log(\"this----\"+this)\n                    this.addPlayerNode(playerdata_list[i])\n                }\n\n                if (this.isopen_sound) {\n                    cc.audioEngine.stopAll()\n                    // cc.audioEngine.play(cc.url.raw(\"resources/sound/bg.mp3\"), true)\n                }\n            }\n            var gamebefore_node = this.node.getChildByName(\"gamebeforeUI\")\n            gamebefore_node.emit(\"init\")\n        }.bind(this))\n\n        //在进入房间后，注册其他玩家进入房间的事件\n        myglobal.socket.onPlayerJoinRoom(function (join_playerdata) {\n            //回调的函数参数是进入房间用户消息\n            console.log(\"onPlayerJoinRoom:\" + JSON.stringify(join_playerdata))\n            this.addPlayerNode(join_playerdata)\n        }.bind(this))\n\n        //回调参数是发送准备消息的accountid\n        myglobal.socket.onPlayerReady(function (data) {\n            console.log(\"-------onPlayerReady:\" + data)\n            for (var i = 0; i < this.playerNodeList.length; i++) {\n                var node = this.playerNodeList[i]\n                if (node) {\n                    node.emit(\"player_ready_notify\", data)\n                }\n            }\n        }.bind(this))\n\n        myglobal.socket.onGameStart(function () {\n            for (var i = 0; i < this.playerNodeList.length; i++) {\n                var node = this.playerNodeList[i]\n                if (node) {\n                    node.emit(\"gamestart_event\")\n                }\n            }\n\n            //隐藏gamebeforeUI节点\n            var gamebeforeUI = this.node.getChildByName(\"gamebeforeUI\")\n            if (gamebeforeUI) {\n                gamebeforeUI.active = false\n            }\n        }.bind(this))\n\n        //监听服务器玩家抢地主消息\n        myglobal.socket.onRobState(function (event) {\n            console.log(\"-----onRobState\" + JSON.stringify(event))\n            //onRobState{\"accountid\":\"2162866\",\"state\":1}\n            for (var i = 0; i < this.playerNodeList.length; i++) {\n                var node = this.playerNodeList[i]\n                if (node) {\n                    //给playernode节点发送事件\n                    node.emit(\"playernode_rob_state_event\", event)\n                }\n            }\n        }.bind(this))\n\n        //注册监听服务器确定地主消息\n        myglobal.socket.onChangeMaster(function (event) {\n            console.log(\"onChangeMaster\" + event)\n            //保存一下地主id\n            myglobal. playerData.master_accountid = event\n            for (var i = 0; i < this.playerNodeList.length; i++) {\n                var node = this.playerNodeList[i]\n                if (node) {\n                    //给playernode节点发送事件\n                    node.emit(\"playernode_changemaster_event\", event)\n                }\n            }\n        }.bind(this))\n\n        //注册监听服务器显示底牌消息\n        myglobal.socket.onShowBottomCard(function (event) {\n            console.log(\"onShowBottomCard---------\" + event)\n            var gameui_node = this.node.getChildByName(\"gameingUI\")\n            if (gameui_node == null) {\n                console.log(\"get childer name gameingUI\")\n                return\n            }\n            gameui_node.emit(\"show_bottom_card_event\", event)\n        }.bind(this))\n    }\n\n    //seat_index自己在房间的位置id\n    setPlayerSeatPos(seat_index) {\n        if (seat_index < 1 || seat_index > 3) {\n            console.log(\"seat_index error\" + seat_index)\n            return\n        }\n\n        console.log(\"setPlayerSeatPos seat_index:\" + seat_index)\n\n        //界面位置转化成逻辑位置\n        switch (seat_index) {\n            case 1:\n                this.playerdata_list_pos[1] = 0\n                this.playerdata_list_pos[2] = 1\n                this.playerdata_list_pos[3] = 2\n                break\n            case 2:\n\n\n                this.playerdata_list_pos[2] = 0\n                this.playerdata_list_pos[3] = 1\n                this.playerdata_list_pos[1] = 2\n                break\n            case 3:\n                this.playerdata_list_pos[3] = 0\n                this.playerdata_list_pos[1] = 1\n                this.playerdata_list_pos[2] = 2\n                break\n            default:\n                break\n        }\n\n    }\n\n    addPlayerNode(player_data) {\n        var playernode_inst = cc.instantiate(this.player_node_prefabs)\n        playernode_inst.parent = this.node\n        //创建的节点存储在gamescene的列表中\n        this.playerNodeList.push(playernode_inst)\n\n        //玩家在room里的位置索引(逻辑位置)\n        var index = this.playerdata_list_pos[player_data.seatindex]\n        console.log(\"index \" + player_data.seatindex + \" \" + index)\n        playernode_inst.position = this.players_seat_pos.children[index].position\n        playernode_inst.getComponent(\"player_node\").init_data(player_data, index)\n    }\n\n    start() {\n    }\n\n    /*\n     //通过accountid获取用户出牌放在gamescend的位置 \n     做法：先放3个节点在gameacene的场景中cardsoutzone(012)\n           \n    */\n    getUserOutCardPosByAccount(accountid) {\n        console.log(\"getUserOutCardPosByAccount accountid:\" + accountid)\n        for (var i = 0; i < this.playerNodeList.length; i++) {\n            var node = this.playerNodeList[i]\n            if (node) {\n                //获取节点绑定的组件\n                var node_script = node.getComponent(\"player_node\")\n                //如果accountid和player_node节点绑定的accountid相同\n                //接获取player_node的子节点\n                if (node_script.accountid === accountid) {\n                    var seat_node = this.players_seat_pos.children[node_script.seat_index]\n                    var index_name = \"cardsoutzone\" + node_script.seat_index\n                    //console.log(\"getUserOutCardPosByAccount index_name:\"+index_name)\n                    var out_card_node = seat_node.getChildByName(index_name)\n                    //console.log(\"OutZone:\"+ out_card_node.name)\n                    return out_card_node\n                }\n            }\n        }\n\n        return null\n    }\n    // update (dt) {},\n}\n"]}