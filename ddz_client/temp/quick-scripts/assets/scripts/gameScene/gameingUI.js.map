{"version":3,"sources":["gameingUI.js"],"names":["cc","Class","extends","Component","properties","gameingUI","Node","card_prefab","Prefab","robUI","bottom_card_pos_node","playingUI_node","tipsLabel","Label","onLoad","cards_nods","card_width","rob_player_accountid","fapai_end","bottom_card","bottom_card_data","choose_card_data","outcar_zone","push_card_tmp","myglobal","socket","onPushCards","data","console","log","JSON","stringify","card_data","cur_index_card","length","pushCard","isopen_sound","fapai_audioID","scheduleOnce","_runactive_pushcard","bind","node","parent","emit","onCanRobState","playerData","accountID","active","onCanChuCard","clearOutZone","onOtherPlayerChuCard","accountid","gameScene_script","getComponent","outCard_node","getUserOutCardPosByAccount","node_cards","i","cards","card","instantiate","showCards","push","appendOtherCardsToOutZone","on","show_data","call_data","run","callFunc","target","activedata","show_card","obj","runAction","sequence","rotateBy","scaleBy","audioEngine","play","url","raw","master_accountid","pushThreeCard","event","detail","cardid","splice","start","stop","sendevent","move_node","newx","x","action","moveTo","v2","sortCard","sort","y","a","b","hasOwnProperty","value","king","timeout","setTimeout","zIndex","width","scale","di_card","position","schedulePushThreeCard","last_card_x","destoryCard","choose_card","destroy_card","j","card_id","removeFromParent","appendCardsToOutZone","updateCards","children","destroy","removeAllChildren","pushCardSort","yoffset","addChild","zPoint","cardNode","getChildren","setScale","setPosition","zeroPoint","playPushCardSound","card_name","CardsValue","one","name","double","onButtonClick","customData","requestRobState","qian_state","qian","buqiang","request_buchu_card","string","request_chu_card","err","msg","cardvalue","account"],"mappings":"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","file":"gameingUI.js","sourceRoot":"../../../../../assets/scripts/gameScene","sourcesContent":["import myglobal from \"../../mygolbal.js\"\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gameingUI: cc.Node,\n        card_prefab:cc.Prefab,\n        robUI:cc.Node,\n        bottom_card_pos_node:cc.Node,\n        playingUI_node:cc.Node,\n        tipsLabel:cc.Label, //玩家出牌不合法的tips\n    \n    },\n\n    onLoad () {\n        //自己牌列表 \n        this.cards_nods = []\n        this.card_width = 0\n        //当前可以抢地主的accountid\n        this.rob_player_accountid = 0\n        //发牌动画是否结束\n        this.fapai_end = false\n        //底牌数组\n        this.bottom_card = []\n        //底牌的json对象数据\n        this.bottom_card_data=[]\n        this.choose_card_data=[]\n        this.outcar_zone = []\n\n        this.push_card_tmp = []\n        //监听服务器:下发牌消息\n        myglobal.socket.onPushCards(function(data){\n            console.log(\"onPushCards\"+JSON.stringify(data))\n            this.card_data = data\n            this.cur_index_card = data.length - 1\n            this.pushCard(data)\n            if(isopen_sound){\n                //循环播放发牌音效\n               // this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"),true)\n                console.log(\"start fapai_audioID\"+this.fapai_audioID) \n            }\n             //左边移动定时器\n            this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\n            this.node.parent.emit(\"pushcard_other_event\")\n           \n        }.bind(this))\n\n        //监听服务器:通知抢地主消息,显示相应的UI\n        myglobal.socket.onCanRobState(function(data){\n            console.log(\"onCanRobState\"+JSON.stringify(data))\n            //这里需要2个变量条件：自己是下一个抢地主，2发牌动画结束\n            this.rob_player_accountid = data\n            if(data==myglobal.playerData.accountID && this.fapai_end==true){\n                this.robUI.active = true\n            }\n          \n        }.bind(this))\n        \n        //监听服务器可以出牌消息\n        myglobal.socket.onCanChuCard(function(data){\n            console.log(\"onCanRobState\"+JSON.stringify(data))\n            //判断是不是自己能出牌\n            if(data==myglobal.playerData.accountID){\n                //先清理出牌区域\n                this.clearOutZone(myglobal.playerData.accountID)\n                //先把自己出牌列表置空\n                //this.choose_card_data=[]\n                //显示可以出牌的UI\n                this.playingUI_node.active = true\n\n            }\n        }.bind(this))\n\n        //监听服务器：其他玩家出牌消息\n        myglobal.socket.onOtherPlayerChuCard(function(data){\n            //{\"accountid\":\"2357540\",\"cards\":[{\"cardid\":4,\"card_data\":{\"index\":4,\"value\":1,\"shape\":1}}]}\n            console.log(\"onOtherPlayerChuCard\"+JSON.stringify(data))\n\n            var accountid = data.accountid\n            var gameScene_script = this.node.parent.getComponent(\"gameScene\")\n            //获取出牌区域节点\n            var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\n            if(outCard_node==null){\n                return\n            }\n\n            var node_cards = []\n            for(var i=0;i<data.cards.length;i++){\n                var card = cc.instantiate(this.card_prefab)\n                card.getComponent(\"card\").showCards(data.cards[i].card_data,myglobal.playerData.accountID)\n                node_cards.push(card)\n            }\n            this.appendOtherCardsToOutZone(outCard_node,node_cards,0)\n\n            \n        }.bind(this))\n\n        //内部事件:显示底牌事件,data是三张底牌数据\n        this.node.on(\"show_bottom_card_event\",function(data){\n            console.log(\"----show_bottom_card_event\",+data)\n          \n            this.bottom_card_data = data\n            \n            for(var i=0;i<data.length;i++){\n                var card = this.bottom_card[i]\n                var show_data = data[i]\n                var call_data = {\n                    \"obj\":card,\n                    \"data\":show_data,\n                }\n                console.log(\"bottom show_data:\"+JSON.stringify(show_data))\n                var run =  cc.callFunc(function(target,activedata){\n                   \n                    var show_card = activedata.obj\n                    var show_data = activedata.data\n                    //console.log(\"cc.callFunc:\"+JSON.stringify(show_data))\n                    show_card.getComponent(\"card\").showCards(show_data)\n                   \n                },this,call_data)\n\n                card.runAction(cc.sequence(cc.rotateBy(0,0,180),cc.rotateBy(0.2,0,-90), run,\n                cc.rotateBy(0.2,0,-90),cc.scaleBy(1, 1.2)));\n               \n                if(isopen_sound){\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/start.mp3\")) \n                 }\n            }\n\n            //this.node.parent.emit(\"change_room_state_event\",RoomState.ROOM_PLAYING)\n            //如果自己地主，给加上三张底牌\n            if(myglobal.playerData.accountID==myglobal.playerData.master_accountid){\n                this.scheduleOnce(this.pushThreeCard.bind(this),0.2)\n            }\n            \n              \n        }.bind(this))\n\n        //注册监听一个选择牌消息 \n        this.node.on(\"choose_card_event\",function(event){\n            console.log(\"choose_card_event:\"+JSON.stringify(event))\n            var detail = event\n            this.choose_card_data.push(detail)\n        }.bind(this))\n\n        this.node.on(\"unchoose_card_event\",function(event){\n            console.log(\"unchoose_card_event:\"+ event)\n            var detail = event\n            for(var i=0;i<this.choose_card_data.length;i++){\n                if(this.choose_card_data[i].cardid==detail){\n                    this.choose_card_data.splice(i,1)\n                }\n            }\n        }.bind(this))\n\n    },\n\n    start () {\n     \n    },\n\n    //处理发牌的效果\n    _runactive_pushcard(){\n        //console.log(\"_runactive_pushcard:\"+this.cur_index_card)\n        if(this.cur_index_card < 0){\n            console.log(\"pushcard end\")\n            //发牌动画完成，显示抢地主按钮\n            //this.robUI.active = true\n            this.fapai_end = true\n            if(this.rob_player_accountid==myglobal.playerData.accountID){\n                this.robUI.active = true\n            }\n\n            if(isopen_sound){\n                //console.log(\"start fapai_audioID\"+this.fapai_audioID) \n                cc.audioEngine.stop(this.fapai_audioID)\n            }\n           \n\n              //通知gamescene节点，倒计时\n            var sendevent = this.rob_player_accountid\n            this.node.parent.emit(\"canrob_event\",sendevent)\n\n            return\n        }\n\n        //原有逻辑  \n        // var move_node = this.cards_nods[this.cur_index_card]\n        // move_node.active = true\n        // var newx = move_node.x + (this.card_width * 0.4*this.cur_index_card) - (this.card_width * 0.4)\n        // var action = cc.moveTo(0.1, cc.v2(newx, -250));\n        // move_node.runAction(action)\n        // this.cur_index_card--\n        // this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\n\n        \n        var move_node = this.cards_nods[this.cards_nods.length-this.cur_index_card-1]\n        move_node.active = true\n        this.push_card_tmp.push(move_node)\n        this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"))\n        for(var i=0;i<this.push_card_tmp.length-1;i++){\n                var move_node = this.push_card_tmp[i]\n                var newx = move_node.x - (this.card_width * 0.4)\n                var action = cc.moveTo(0.1, cc.v2(newx, -250));\n                move_node.runAction(action)\n        }\n        \n        this.cur_index_card--\n        this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\n    },\n \n    //对牌排序\n    sortCard(){\n        this.cards_nods.sort(function(x,y){\n            var a = x.getComponent(\"card\").card_data;\n            var b = y.getComponent(\"card\").card_data;\n\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\n                return  b.value-a.value;\n            }\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\n                return -1;\n            }\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return 1;\n            }\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return  b.king-a.king;\n            }\n        })\n        //var x = this.cards_nods[0].x;\n        //这里使用固定坐标，因为取this.cards_nods[0].xk可能排序为完成，导致x错误\n        //所以做1000毫秒的延时\n        var timeout = 1000\n        setTimeout(function(){\n            //var x = -417.6 \n            var x = this.cards_nods[0].x;\n            console.log(\"sort x:\"+ x)\n            for (let i = 0; i < this.cards_nods.length; i++) {\n                var card = this.cards_nods[i];\n                card.zIndex = i; //设置牌的叠加次序,zindex越大显示在上面\n                card.x = x + card.width * 0.4 * i;\n            }\n        }.bind(this), timeout);\n        \n       \n    },\n\n  \n    pushCard(data){\n    if (data) {\n            data.sort(function (a, b) {\n                if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\n                    return b.value - a.value;\n                }\n                if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\n                    return -1;\n                }\n                if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                    return 1;\n                }\n                if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                    return b.king - a.king;\n                }\n            });\n        }\n      //创建card预制体\n      this.cards_nods = []\n      for(var i=0;i<17;i++){\n        \n        var card = cc.instantiate(this.card_prefab)\n        card.scale=0.8\n        card.parent = this.node.parent\n        //card.x = card.width * 0.4 * (17 - 1) * (-0.5) + card.width * 0.4 * 0;\n        card.x = card.width * 0.4 * (-0.5) * (-16) + card.width * 0.4 * 0;\n        //这里实现为，每发一张牌，放在已经发的牌最后，然后整体移动\n        card.y = -250\n        card.active = false\n\n        card.getComponent(\"card\").showCards(data[i],myglobal.playerData.accountID)\n        //存储牌的信息,用于后面发牌效果\n        this.cards_nods.push(card)\n        this.card_width = card.width\n      }\n      \n      //创建3张底牌\n      this.bottom_card = []\n      for(var i=0;i<3;i++){\n        var di_card = cc.instantiate(this.card_prefab)\n        di_card.scale=0.4\n        di_card.position = this.bottom_card_pos_node.position \n        //三张牌，中间坐标就是bottom_card_pos_node节点坐标，\n        //0,和2两张牌左右移动windth*0.4\n        if(i==0){\n            \n            di_card.x = di_card.x - di_card.width*0.4\n        }else if(i==2){\n            di_card.x = di_card.x + di_card.width*0.4\n        }\n        \n\n        //di_card.x = di_card.width-i*di_card.width-20\n        //di_card.y=60\n        di_card.parent = this.node.parent\n        //存储在容器里\n        this.bottom_card.push(di_card)\n      }\n\n    },\n\n    //给玩家发送三张底牌后，过1s,把牌设置到y=-250位置效果\n    schedulePushThreeCard(){\n        for(var i=0;i<this.cards_nods.length;i++){\n            var card = this.cards_nods[i]\n            if(card.y==-230){\n                card.y = -250\n            }\n        }\n    },\n    //给地主发三张排，并显示在原有牌的后面\n    pushThreeCard(){\n        //每张牌的其实位置 \n        var last_card_x =  this.cards_nods[this.cards_nods.length-1].x\n        for(var i=0;i<this.bottom_card_data.length;i++){\n            var card = cc.instantiate(this.card_prefab)\n            card.scale=0.8\n            card.parent = this.node.parent\n          \n            card.x = last_card_x + ((i+1)*this.card_width * 0.4)\n            card.y = -230  //先把底盘放在-230，在设置个定时器下移到-250的位置\n           \n            //console.log(\"pushThreeCard x:\"+card.x)\n            card.getComponent(\"card\").showCards(this.bottom_card_data[i],myglobal.playerData.accountID)\n            card.active = true\n            this.cards_nods.push(card)\n        }\n\n        this.sortCard()\n        //设置一个定时器，在2s后，修改y坐标为-250\n        this.scheduleOnce(this.schedulePushThreeCard.bind(this),2)\n\n    },\n\n    destoryCard(accountid,choose_card){\n        if(choose_card.length==0){\n            return\n        }\n\n        /*出牌逻辑\n          1. 将选中的牌 从父节点中移除\n          2. 从this.cards_nods 数组中，删除 选中的牌 \n          3. 将 “选中的牌” 添加到出牌区域\n              3.1 清空出牌区域\n              3.2 添加子节点\n              3.3 设置scale\n              3.4 设置position\n          4.  重新设置手中的牌的位置  this.updateCards();\n        */\n        //1/2步骤删除自己手上的card节点 \n        var destroy_card = []\n        for(var i=0;i<choose_card.length;i++){\n            for(var j=0;j<this.cards_nods.length;j++){\n                var card_id = this.cards_nods[j].getComponent(\"card\").card_id\n                if(card_id==choose_card[i].cardid){\n                    console.log(\"destroy card id:\"+card_id)\n                    //this.cards_nods[j].destroy()\n                    this.cards_nods[j].removeFromParent(true);\n                    destroy_card.push(this.cards_nods[j])\n                    this.cards_nods.splice(j,1)\n                }\n            }\n        }\n\n        this.appendCardsToOutZone(accountid,destroy_card)\n        this.updateCards()\n\n    },\n\n    //清除显示出牌节点全部子节点(就是把出牌的清空)\n    clearOutZone(accountid){\n        var gameScene_script = this.node.parent.getComponent(\"gameScene\")\n        var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\n        var children = outCard_node.children;\n        for(var i=0;i<children.length;i++){\n            var card = children[i]; \n            card.destroy()\n        }\n        outCard_node.removeAllChildren(true);\n    },\n    //对出的牌做排序\n    pushCardSort(cards){\n        if(cards.length==1){\n            return\n        }\n        cards.sort(function(x,y){\n            var a = x.getComponent(\"card\").card_data;\n            var b = y.getComponent(\"card\").card_data;\n\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\n                return b.value - a.value;\n            }\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\n                return -1;\n            }\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return 1;\n            }\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\n                return b.king - a.king;\n            }\n        })\n    },\n\n    appendOtherCardsToOutZone(outCard_node,cards,yoffset){\n       outCard_node.removeAllChildren(true);\n\n       //console.log(\"appendOtherCardsToOutZone length\"+cards.length)\n       //添加新的子节点\n       for(var i=0;i<cards.length;i++){\n           var card = cards[i]; \n           outCard_node.addChild(card,100+i) //第二个参数是zorder,保证牌不能被遮住\n       }\n\n       //对出牌进行排序\n       //设置出牌节点的坐标\n       var zPoint = cards.length / 2;\n       //console.log(\"appendOtherCardsToOutZone zeroPoint:\"+zPoint)\n       for(var i=0;i<cards.length;i++){\n        var cardNode = outCard_node.getChildren()[i]\n        var x = (i - zPoint) * 30;\n        var y = cardNode.y+yoffset; //因为每个节点需要的Y不一样，做参数传入\n        //console.log(\"-----cardNode: x:\"+x+\" y:\"+y)\n        cardNode.setScale(0.5, 0.5);                   \n        cardNode.setPosition(x,y);                     \n\n       }\n    },\n    //将 “选中的牌” 添加到出牌区域\n    //destroy_card是玩家本次出的牌\n    appendCardsToOutZone(accountid,destroy_card){\n        if(destroy_card.length==0){\n            return\n        }\n        //先给本次出的牌做一个排序\n       this.pushCardSort(destroy_card)\n       //console.log(\"appendCardsToOutZone\")\n       var gameScene_script = this.node.parent.getComponent(\"gameScene\")\n       //获取出牌区域节点\n       var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\n       this.appendOtherCardsToOutZone(outCard_node,destroy_card,360)\n       //sconsole.log(\"OutZone:\"+outCard_node.name)\n\n    },\n\n    //重新排序手上的牌,并移动\n    updateCards(){\n    \n        var zeroPoint = this.cards_nods.length / 2;\n        //var last_card_x = this.cards_nods[this.cards_nods.length-1].x\n        for(var i=0;i<this.cards_nods.length;i++){\n            var cardNode = this.cards_nods[i]\n            var x = (i - zeroPoint)*(this.card_width * 0.4);\n            cardNode.setPosition(x, -250);  \n        }\n\n    },\n    \n    playPushCardSound(card_name){\n        console.log(\"playPushCardSound:\"+card_name)\n        \n        if(card_name==\"\"){\n            return\n        }\n\n        switch(card_name){\n            case CardsValue.one.name:\n                break\n            case CardsValue.double.name:\n                    if(isopen_sound){\n                        cc.audioEngine.play(cc.url.raw(\"resources/sound/duizi.mp3\")) \n                     }\n                break  \n        }\n    },\n    // update (dt) {},\n    onButtonClick(event,customData){\n        switch(customData){\n            case \"btn_qiandz\":\n                console.log(\"btn_qiandz\")\n                myglobal.socket.requestRobState(qian_state.qian)\n                this.robUI.active = false\n                if(isopen_sound){\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_jiao_di_zhu.ogg\")) \n                 }\n                break\n            case \"btn_buqiandz\":\n                console.log(\"btn_buqiandz\")\n                myglobal.socket.requestRobState(qian_state.buqiang)\n                this.robUI.active = false\n                if(isopen_sound){\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_bu_jiao.ogg\")) \n                 }\n                 break    \n             case \"nopushcard\":  //不出牌\n                 myglobal.socket.request_buchu_card([],null)\n                 this.playingUI_node.active = false\n                 break\n             case \"pushcard\":   //出牌\n                 //先获取本次出牌数据\n                 if(this.choose_card_data.length==0){\n                    this.tipsLabel.string=\"请选择牌!\"\n                    setTimeout(function(){\n                        this.tipsLabel.string=\"\"\n                    }.bind(this), 2000);\n                 }\n                 myglobal.socket.request_chu_card(this.choose_card_data,function(err,data){\n                   \n                    if(err){\n                        console.log(\"request_chu_card:\"+err)\n                        console.log(\"request_chu_card\"+JSON.stringify(data))\n                        if(this.tipsLabel.string==\"\"){\n                            this.tipsLabel.string = data.msg\n                            setTimeout(function(){\n                                this.tipsLabel.string=\"\"\n                            }.bind(this), 2000);\n                        }\n                        \n                        //出牌失败，把选择的牌归位\n                        for(var i=0;i<this.cards_nods.length;i++){\n                            var card = this.cards_nods[i]\n                            card.emit(\"reset_card_flag\")\n                        }\n                        this.choose_card_data = []\n                     }else{\n                         //出牌成功\n                         console.log(\"resp_chu_card data:\"+JSON.stringify(data))\n                         this.playingUI_node.active = false\n                         //播放出牌的声音\n                         //resp_chu_card data:{\"account\":\"2519901\",\"msg\":\"sucess\",\"cardvalue\":{\"name\":\"Double\",\"value\":1}}\n                         //{\"type\":\"other_chucard_notify\",\"result\":0,\"data\":{\"accountid\":\"2519901\",\"cards\":[{\"cardid\":24,\"card_data\":{\"index\":24,\"value\":6,\"shape\":1}},{\"cardid\":26,\"card_data\":{\"index\":26,\"value\":6,\"shape\":3}}]},\"callBackIndex\":0}\n                         this.playPushCardSound(data.cardvalue.name)\n                         this.destoryCard(data.account,this.choose_card_data)\n                         this.choose_card_data = []\n                     \n                     }\n                    \n                 }.bind(this))\n                 //this.playingUI_node.active = false\n                 break\n             case \"tipcard\":\n                 break            \n            default:\n                break\n        }\n    }\n\n\n});\n"]}